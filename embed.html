<!DOCTYPE html>
<html lang="en">

<head>
    <title>YouTube no ads player</title>
    <link rel="shortcut icon" href="https://www.youtube.com/s/desktop/82a4cf4f/img/favicon.ico" type="image/x-icon">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        #videoSection {
            visibility: hidden;
        }
    </style>
</head>

<body id="body" class="bg-light text-danger">
    <div class="container">
        <h1 class="text-center">YouTube no ads player</h1>
        <p class="text-center">Play videos from YouTube without annoying advertisements</p>
        <form>
            <div class="form-group">
                <label for="" class="pb-2">Enter YouTube link *:</label>
                <input id="url" class="form-control" type="text"
                    placeholder="e.g. https://www.youtube.com/watch?v=7UfVr5Xib50" onchange="embedVideo()">
                <p class="small pt-2">* links for Shorts videos not supported</p>
            </div>
            <div class="form-group pt-2">
                <button id="clearButton" class="btn btn-danger btn-sm float-right" type="button" onclick="clearInput()">
                    Clear
                </button>
                <div class="form-check form-switch pt-2">
                    <input class="form-check-input" type="checkbox" id="mySwitch" name="darkmode" value="yes"
                        onclick="switchMode()">
                    <label class="form-check-label" for="mySwitch">Dark mode</label>
                </div>
            </div>
        </form>
        <div class="row d-flex justify-content-center">
            <div id="videoSection" class="col-md-6">
                <iframe id="video" class="float-start" width="560" height="315" src="" title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
            </div>
        </div>
    </div>

    <script type="text/javascript">

        function clearInput() {
            console.log("Clearing input...")
            document.getElementById('url').value = "";
        }

        function switchMode() {
            var body = document.getElementById("body");
            var clearButton = document.getElementById("clearButton");
            var urlInput = document.getElementById("url");
            if (body.className.includes("bg-dark")) {
                console.log("Switching to light mode...")
                body.classList.remove("text-opacity-50")
                body.classList.remove("bg-dark")
                body.classList.add("text-danger")
                body.classList.add("bg-light")
                clearButton.classList.remove("btn-outline-danger")
                clearButton.classList.add("btn-danger")
                urlInput.classList.remove("bg-dark")
                urlInput.classList.remove("border-danger")
                urlInput.style.color = ""
            } else {
                console.log("Switching to dark mode...")
                body.classList.add("bg-dark")
                body.classList.add("text-opacity-50")
                body.classList.remove("bg-light")
                clearButton.classList.add("btn-outline-danger")
                clearButton.classList.remove("btn-danger")
                urlInput.classList.add("bg-dark")
                urlInput.classList.add("border-danger")
                urlInput.style.color = "#ff0000c6"
            }
        }

        function isNullOrEmpty(str) {
            return str == null || str === ""
        }

        function embedVideo() {
            let url = document.getElementById('url').value;
            console.log('url inserted is: ' + url)

            let urlObj = new URL(url);
            let path = urlObj.pathname.replace('/', '');
            let params = urlObj.searchParams
            let vParam = params.get('v')
            let listParam = params.get('list')
            let indexParam = params.get('index')
            let embedUrlBase = "https://www.youtube.com/embed/"
            let defaultVideoId = "Ygg0bXls8CA"
            let embedUrl;
            if (isNullOrEmpty(vParam) && isNullOrEmpty(listParam) && isNullOrEmpty(indexParam) && !isNullOrEmpty(path)) {   // like https://youtu.be/7UfVr5Xib50
                let videoId = urlObj.pathname.replace('/', '');
                embedUrl = embedUrlBase + videoId;
                console.log('Set embed url for single video - no v param: ' + embedUrl)
            } else if (!isNullOrEmpty(vParam) && isNullOrEmpty(listParam) && isNullOrEmpty(indexParam)) {                   // like https://www.youtube.com/watch?v=7UfVr5Xib50
                embedUrl = embedUrlBase + vParam
                console.log('Set embed url for single video - with v param: ' + embedUrl)
            } else if (!isNullOrEmpty(listParam) && isNullOrEmpty(indexParam)) {                                            // like https://youtube.com/playlist?list=PLpT23Oq1XOBCs3qJY2GXBgxJUvtp6eC5g
                embedUrl = embedUrlBase + "videoseries?list=" + listParam                                                   // or   https://www.youtube.com/watch?v=uOJDCEapPpM&list=PLpT23Oq1XOBCs3qJY2GXBgxJUvtp6eC5g
                console.log('Set embed url for playlist - no index: ' + embedUrl)
            } else if (!isNullOrEmpty(listParam) && !isNullOrEmpty(indexParam)) {                                           // like https://www.youtube.com/watch?v=uOJDCEapPpM&list=PLpT23Oq1XOBCs3qJY2GXBgxJUvtp6eC5g&index=2
                embedUrl = embedUrlBase + "playlist?list=" + listParam + "&index=" + indexParam
                console.log('Set embed url for playlist - with index: ' + embedUrl)
            } else {
                embedUrl = embedUrlBase + defaultVideoId;
                console.log('Set embed url to default: ' + embedUrl)
            }
            document.getElementById('video').setAttribute('src', embedUrl);
            document.getElementById('videoSection').style.visibility = "visible";
        }
    </script>
</body>

</html>
