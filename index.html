<!DOCTYPE html>
<html lang="en">

<head>

    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>&#x1F648;</text></svg>">
    <title>YouTube no ads player</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.1/jquery.min.js"></script>

    <meta name="viewport" content="width=device-width, initial-scale=1">
    <style>
        #videoSection {
            visibility: hidden;
        }

        .carousel-inner {
            padding: 1em;
        }

        .card {
            margin: 0 0.5em;
            box-shadow: 2px 6px 8px 0 rgba(22, 22, 26, 0.18);
            border: none;
        }

        .carousel-control-prev,
        .carousel-control-next {
            background-color: #e1e1e1;
            width: 6vh;
            height: 6vh;
            border-radius: 50%;
            top: 50%;
            transform: translateY(-50%);
        }

        @media (min-width: 768px) {
            .carousel-item {
                margin-right: 0;
                flex: 0 0 33.333333%;
                display: block;
            }

            .carousel-inner {
                display: flex;
            }
        }

        .card .img-wrapper {
            max-width: 100%;
            height: 13em;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .card img {
            max-height: 100%;
        }

        @media (max-width: 767px) {
            .card .img-wrapper {
                height: 17em;
            }
        }
    </style>
</head>

<body id="body" class="bg-light text-danger">
    <div class="container">
        <h1 class="text-center pt-3">YouTube no ads player</h1>
        <p class="text-center">Play videos from YouTube without annoying advertisements</p>
        <div>
            <div class="form-group">
                <label for="" class="pb-2">Enter YouTube link:</label>
                <input id="url" class="form-control" type="text"
                    placeholder="e.g. https://www.youtube.com/watch?v=7UfVr5Xib50" onchange="embedVideo()">
                <p id="errorMsg" class="small pt-2"></p>
            </div>
            <div class="form-group pt-2">
                <button id="clearButton" class="btn btn-danger btn-sm float-right" type="button" onclick="clearInput()">
                    Clear
                </button>
                <div class="form-check form-switch pt-2">
                    <input class="form-check-input" type="checkbox" id="mySwitch" name="darkmode" value="yes"
                        onclick="switchMode()">
                    <label class="form-check-label" for="mySwitch">Dark mode</label>
                </div>
            </div>
        </div>
        <div id="videoSectionParent" class="row d-flex justify-content-center">
            <div id="videoSection" class="row d-flex justify-content-center">
                <iframe id="video" class="float-start" width="560" height="315" src="" title="YouTube video player"
                    frameborder="0"
                    allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share"
                    allowfullscreen></iframe>
            </div>
        </div>
        <div class="form-group pt-2">
            <label for="" class="pb-2">Search on YouTube:</label>
            <input id="seachInput" class="form-control" type="text" placeholder="e.g. Funny cats"
                onchange="searchYouTube()">
            <p id="errorMsg" class="small pt-2"></p>
        </div>
        <div class="form-check form-switch pt-2">
            <input class="form-check-input" type="checkbox" id="playlistSwitch" name="playlist" value="yes"
                onclick="searchYouTube()">
            <label class="form-check-label" for="playlistSwitch">Search for playlist</label>
        </div>

        <div id="carouselExampleControls" class="carousel" data-bs-ride="carousel">
            <div id="carouselParent" class="carousel-inner">
                <!-- repeated blocks ... -->
            </div>
            <button class="carousel-control-prev" type="button" data-bs-target="#carouselExampleControls"
                data-bs-slide="prev">
                <span class="carousel-control-prev-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Previous</span>
            </button>
            <button class="carousel-control-next" type="button" data-bs-target="#carouselExampleControls"
                data-bs-slide="next">
                <span class="carousel-control-next-icon" aria-hidden="true"></span>
                <span class="visually-hidden">Next</span>
            </button>
        </div>


    </div>

    <script src="./youtube_embed.js" type="text/javascript"></script>
    <script src="https://apis.google.com/js/api.js"></script>
    <script>
        function searchYouTube() {
            document.getElementById("carouselParent").innerHTML = "";
            var searchTerm = document.getElementById('seachInput').value;
            var APIkey = "";    // replace with API key
            var resultType = "video"
            var videoBaseUrl = "https://www.youtube.com/watch?v="
            if (document.getElementById("playlistSwitch").checked) {
                resultType = "playlist"
                videoBaseUrl = "https://www.youtube.com/watch?list="
            }

            fetch('https://youtube.googleapis.com/youtube/v3/search?part=snippet&maxResults=25&q=' + searchTerm + '&type=' + resultType + '&key=' + APIkey)
                .then(response => response.json())
                .then(data => {
                    console.log(data.items);
                    data.items.forEach(element => {
                        var carouselParent = document.getElementById("carouselParent");

                        var carouselElement = document.createElement("div")
                        carouselElement.classList.add("carousel-item");
                        carouselElement.setAttribute("onclick", "embedMe(this)")

                        var videoUrl = document.createElement("p")
                        if (document.getElementById("playlistSwitch").checked) {
                            videoUrl.innerText = videoBaseUrl + element.id.playlistId
                        } else {
                            videoUrl.innerText = videoBaseUrl + element.id.videoId
                        }
                        videoUrl.style.visibility = "hidden"
                        carouselElement.appendChild(videoUrl)

                        var carouselCard = document.createElement("div")
                        carouselCard.classList.add("card");

                        var imageWrapper = document.createElement("div")
                        imageWrapper.classList.add("img-wrapper");
                        imageWrapper.setAttribute("alt", "...")
                        var image = document.createElement("img");
                        image.setAttribute("src", element.snippet.thumbnails.high.url)
                        image.classList.add("d-block");
                        image.classList.add("w-100");
                        imageWrapper.appendChild(image)

                        var cardBody = document.createElement("div")
                        cardBody.classList.add("card-body")
                        var cardTitle = document.createElement("h5")
                        cardTitle.classList.add("card-title")
                        cardTitle.innerText = element.snippet.title;
                        var cardDescription = document.createElement("p")
                        cardDescription.classList.add("card-text")
                        cardDescription.innerText = element.snippet.description
                        cardBody.appendChild(cardTitle)
                        cardBody.appendChild(cardDescription)

                        carouselCard.appendChild(imageWrapper)
                        carouselCard.appendChild(cardBody)

                        carouselElement.appendChild(carouselCard)

                        carouselParent.appendChild(carouselElement)

                        document.getElementsByClassName("carousel-item")[0].classList.add("active")

                    });
                    loadCarouselScript()
                })
        }
    </script>
    <script>
        function loadCarouselScript() {
            console.log("loading carousel script...")
            var body = document.getElementsByTagName("body")[0];
            var existingScript = document.getElementById("carouselScript");
            if (existingScript) {
                body.removeChild()
            }
            var carouselScript = document.createElement("script");
            carouselScript.src = "./carousel.js";
            carouselScript.id = "carouselScript";
            body.appendChild(carouselScript)
        }
    </script>
</body>

</html>